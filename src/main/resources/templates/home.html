<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Home - Shalom+</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #003366;
        color: #333;
      }

      header {
        background-color: #003366;
        color: white;
        padding: 20px;
        text-align: center;
        font-size: 1.5em;
        font-weight: bold;
      }

      nav { margin-top: 10px; }
      nav span { font-weight: bold; }
      nav a { color: white; text-decoration: none; margin-left: 15px; }
      .sair:hover { color: #002244; }

      main {
        max-width: 900px;
        margin: 30px auto;
        padding: 20px;
      }

      h2 { color: white; margin: 18px 0 10px; }

      .btn {
        padding: 8px 15px;
        font-size: 1em;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        text-decoration: none;
        color: white;
        background-color: #002244;
        transition: background-color 0.3s;
        display: inline-block;
      }
      .btn:hover { background-color: #002250; }

      .card {
        background-color: #ffffff;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 15px 20px;
        margin-bottom: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
      }

      .card-info p { margin: 5px 0; }
      .actions { display: flex; gap: 10px; flex-wrap: wrap; }

      .badge {
        display: inline-block;
        padding: 3px 8px;
        border-radius: 999px;
        font-size: 12px;
        font-weight: bold;
        color: white;
      }
      .b-agendado { background: #1d4ed8; }
      .b-realizado { background: #16a34a; }
      .b-cancelado { background: #ef4444; }

      footer {
        text-align: center;
        padding: 15px;
        margin-top: 30px;
        border-top: 1px solid #003366;
        color: #ffffffff;
      }

      .admin-links {
        margin: 20px 0;
        display: flex;
        justify-content: center;
        gap: 12px;
        flex-wrap: wrap;
      }
    </style>
  </head>

  <body>
    <header>
      Bem-vindo(a) ao Shalom+
      <nav>
        <span th:text="'Ol치, ' + ${usuario.nome} + ' (' + ${tipoUsuario} + ')'"></span>
        |
        <a th:href="@{/auth/logout}" class="sair">Sair</a>
      </nav>
    </header>

    <main>
      <!-- ADMIN -->
      <div th:if="${tipoUsuario == 'ADMIN'}" class="admin-links">
        <a th:href="@{/aluno/listar}" class="btn">Gerenciar Alunos</a>
        <a th:href="@{/profissional/listar}" class="btn">Gerenciar Profissionais</a>
        <a th:href="@{/secretario/listar}" class="btn">Gerenciar Secret치rios</a>
      </div>

      <!-- SECRETARIO -->
      <div th:if="${tipoUsuario == 'SECRETARIO'}">
        <a th:href="@{/atendimento/novo}" class="btn" style="margin-bottom: 14px;">Novo Atendimento</a>

        <h2>Todos os atendimentos</h2>

        <div th:if="${#lists.isEmpty(atendimentos)}" style="color:white;">
          Nenhum atendimento cadastrado.
        </div>

        <div th:each="a : ${atendimentos}" class="card">
          <div class="card-info">
            <p><strong>Aluno:</strong> <span th:text="${a.aluno.nome}"></span></p>
            <p><strong>Profissional:</strong> <span th:text="${a.profissional.nome}"></span></p>
            <p><strong>Data/Hora:</strong>
              <span th:text="${#temporals.format(a.dataHora, 'dd/MM/yyyy HH:mm')}"></span>
            </p>
            <p><strong>Tipo:</strong> <span th:text="${a.tipo}"></span></p>
            <p>
              <strong>Status:</strong>
              <span class="badge b-cancelado" th:if="${a.cancelado}">CANCELADO</span>
              <span class="badge b-realizado" th:if="${a.cancelado != true and a.realizado == true}">REALIZADO</span>
              <span class="badge b-agendado" th:if="${a.cancelado != true and a.realizado != true}">AGENDADO</span>
            </p>
          </div>

          <div class="actions">
            <a th:href="@{/atendimento/detalhes/{id}(id=${a.id})}" class="btn">Ver Detalhes</a>
            <a th:if="${a.cancelado != true}" th:href="@{/atendimento/cancelar/{id}(id=${a.id})}"
               class="btn"
               onclick="return confirm('Cancelar este atendimento?');">Cancelar</a>
          </div>
        </div>
      </div>

      <!-- ALUNO / PROFISSIONAL -->
      <div th:if="${tipoUsuario == 'ALUNO' or tipoUsuario == 'PROFISSIONAL'}">
        <h2>Pr칩ximos atendimentos</h2>

        <div th:if="${#lists.isEmpty(proximosAtendimentos)}" style="color:white;">
          Nenhum pr칩ximo atendimento.
        </div>

        <div th:each="a : ${proximosAtendimentos}" class="card">
          <div class="card-info">
            <p th:if="${tipoUsuario != 'ALUNO'}"><strong>Aluno:</strong> <span th:text="${a.aluno.nome}"></span></p>
            <p><strong>Profissional:</strong> <span th:text="${a.profissional.nome}"></span></p>
            <p><strong>Data/Hora:</strong>
              <span th:text="${#temporals.format(a.dataHora, 'dd/MM/yyyy HH:mm')}"></span>
            </p>
            <p><strong>Tipo:</strong> <span th:text="${a.tipo}"></span></p>
            <p>
              <strong>Status:</strong>
              <span class="badge b-realizado" th:if="${a.realizado == true}">REALIZADO</span>
              <span class="badge b-agendado" th:if="${a.realizado != true}">AGENDADO</span>
            </p>
          </div>

          <div class="actions">
            <a th:if="${tipoUsuario == 'PROFISSIONAL'}"
               th:href="@{/atendimento/editar/{id}(id=${a.id})}"
               class="btn">Aba do Profissional</a>
          </div>
        </div>

        <h2>Atendimentos antigos</h2>

        <div th:if="${#lists.isEmpty(atendimentosAntigos)}" style="color:white;">
          Nenhum atendimento antigo.
        </div>

        <div th:each="a : ${atendimentosAntigos}" class="card">
          <div class="card-info">
            <p th:if="${tipoUsuario != 'ALUNO'}"><strong>Aluno:</strong> <span th:text="${a.aluno.nome}"></span></p>
            <p><strong>Profissional:</strong> <span th:text="${a.profissional.nome}"></span></p>
            <p><strong>Data/Hora:</strong>
              <span th:text="${#temporals.format(a.dataHora, 'dd/MM/yyyy HH:mm')}"></span>
            </p>
            <p><strong>Tipo:</strong> <span th:text="${a.tipo}"></span></p>
            <p>
              <strong>Status:</strong>

              <span class="badge b-cancelado" th:if="${a.cancelado == true}">CANCELADO</span>

              <span class="badge b-realizado"
                    th:if="${a.cancelado != true and a.realizado == true}">REALIZADO</span>

              <span class="badge b-agendado"
                    th:if="${a.cancelado != true and a.realizado != true}">AGENDADO</span>
            </p>
          </div>
        </div>
      </div>
    </main>

    <footer>Shalom+ &copy; 2025</footer>
  </body>
</html>
